# -*- coding: utf-8 -*-
"""codigo proyecto

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1h7nTX61nWiFmVz-Qb7dYTl0flaIC8b8i
"""

import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import plotly.express as px


st.set_page_config(page_title="An谩lisis de Secuencias", layout="wide")
st.title(" An谩lisis de Secuencias")
st.markdown("""Este dashboard permite analizar y visualizar datos relacionados con secuencias biol贸gicas.
Utiliza los controles para interactuar con los datos.""")

st.sidebar.title(" Carga de Datos y Configuraci贸n")
uploaded_file = st.sidebar.file_uploader("Sube tu archivo FASTA o CSV", type=["fasta", "csv"])

if uploaded_file:
    progress_bar = st.progress(0)
    status_text = st.empty()

    if uploaded_file.name.endswith(".fasta"):
        status_text.text("Cargando archivo FASTA...")
        progress_bar.progress(25)

        sequences = uploaded_file.getvalue().decode("utf-8").splitlines()
        sequences = [line.strip() for line in sequences if not line.startswith(">")]
        progress_bar.progress(75)

        st.sidebar.success("Archivo FASTA subido correctamente!")
        st.write(f"### N煤mero de secuencias cargadas: {len(sequences)}")
        progress_bar.progress(100)
        status_text.text("Archivo FASTA procesado con 茅xito.")

    else:
        status_text.text("Cargando archivo CSV...")
        progress_bar.progress(25)

        data = pd.read_csv(uploaded_file)
        progress_bar.progress(50)

        st.sidebar.success("Archivo CSV subido correctamente!")
        st.write("### Vista Previa de los Datos")
        st.dataframe(data)
        progress_bar.progress(75)

        st.write("### Estad铆sticas Descriptivas")
        st.dataframe(data.describe())
        progress_bar.progress(100)
        status_text.text("Archivo CSV procesado con 茅xito.")

st.header("Indicadores Clave de Desempe帽o")
col1, col2, col3, col4 = st.columns(4)

with col1:
    st.metric(label=" Precisi贸n de alineaci贸n", value="95.3%")
with col2:
    st.metric(label=" Estructuras predecidas", value="128")
with col3:
    st.metric(label=" Motivos encontrados", value="78")
with col4:
    st.metric(label=" Correlaci贸n estad铆stica", value="0.87", delta="0.02")

st.header("Herramientas Interactivas")
selected_tool = st.radio("Elige una herramienta para analizar tus secuencias:",
                         options=["Alineaci贸n", "Predicci贸n de estructuras", "B煤squeda de motivos", "An谩lisis estad铆stico"])

if selected_tool == "Alineaci贸n":
    st.subheader("Alineaci贸n de Secuencia")
    st.text("Ejemplo: Resultado del algoritmo Needleman-Wunsch")
    st.code("""
    Seq1: AGCTAGC
    Seq2: AGCTG-C
    Puntuaci贸n de alineaci贸n: 92
    """)
elif selected_tool == "Predicci贸n de estructuras":
    st.subheader("Predicci贸n de Estructuras Proteicas")
    st.text("Estructura 3D prevista (Placeholder):")
    st.image("https://via.placeholder.com/300", caption="Estructura 3D prevista")
elif selected_tool == "B煤squeda de motivos":
    st.subheader("B煤squeda de Motivos")
    st.text("Buscando motivos comunes en secuencia...")
    st.write("**Motivos encontrados:** ATG, TATA, CCGG")
elif selected_tool == "An谩lisis estad铆stico":
    st.subheader("An谩lisis de Correlaci贸n Estad铆stica")
    data = {"Contenido": ["Contenido GC", "Contenido AT", "Longitud de la secuencia"],
            "Correlaci贸n con el objetivo": [0.87, -0.56, 0.45]}
    st.table(pd.DataFrame(data))

st.header("Visualizaciones")
tab1, tab2 = st.tabs(["Frecuencia del Motivo", "Distribuci贸n de Contenido GC"])

with tab1:
    motifs = ["ATG", "TATA", "CCGG"]
    frequencies = [25, 15, 10]
    fig = px.bar(x=motifs, y=frequencies, labels={'x': "Motivos", 'y': "Frecuencia"},
                 title="Frecuencia de Motivos", color_discrete_sequence=['violet'])
    st.plotly_chart(fig)

with tab2:
    lengths = np.random.normal(loc=1500, scale=300, size=100)
    fig = px.histogram(x=lengths, nbins=20, labels={'x': "Contenido GC (%)", 'y': "Frecuencia"},
                       title="Distribuci贸n de Contenido GC", color_discrete_sequence=['lightgreen'])
    st.plotly_chart(fig)

if uploaded_file and not uploaded_file.name.endswith(".fasta"):
    st.sidebar.markdown("---")
    st.sidebar.write(" Descarga de Resultados")
    csv = data.to_csv(index=False)
    st.sidebar.download_button(label="Descargar resultados", data=csv, file_name="resultados.csv", mime="text/csv")

st.sidebar.markdown("---")
st.sidebar.write(" Desarrollado por [Yoleth Barrios y Lucero Ramos]")